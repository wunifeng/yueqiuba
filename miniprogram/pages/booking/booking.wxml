<!--pages/booking/booking.wxml-->
<view class="booking-container">
  <!-- é¡¶éƒ¨ç­›é€‰åŒº -->
  <view class="filter-section">
    <!-- åŸå¸‚å’Œè§†å›¾åˆ‡æ¢ -->
    <view class="top-bar">
      <view class="city-selector" bind:tap="onCityTap">
        <text class="location-icon">ğŸ“</text>
        <text class="city-name">{{currentCity}}</text>
        <text class="arrow-down">â–¼</text>
      </view>
      
      <view class="view-toggle">
        <view class="toggle-item {{viewMode === 'list' ? 'active' : ''}}" 
              bind:tap="onViewModeChange" 
              data-mode="list">
          <t-icon name="list" size="32rpx" />
          <text>åˆ—è¡¨</text>
        </view>
        <view class="toggle-item {{viewMode === 'map' ? 'active' : ''}}" 
              bind:tap="onViewModeChange" 
              data-mode="map">
          <t-icon name="location" size="32rpx" />
          <text>åœ°å›¾</text>
        </view>
      </view>
    </view>
    
    <!-- è¿åŠ¨ç±»å‹ç­›é€‰ -->
    <scroll-view class="sport-types" scroll-x>
      <view class="sport-type-item {{filters.sportType === item.id ? 'active' : ''}}"
            wx:for="{{sportTypes}}" 
            wx:key="id"
            bind:tap="onSportTypeSelect"
            data-type="{{item.id}}">
        <text class="sport-icon">{{item.icon}}</text>
        <text class="sport-name">{{item.name}}</text>
      </view>
    </scroll-view>
    
    <!-- é«˜çº§ç­›é€‰æŒ‰é’® -->
    <view class="filter-actions">
      <t-button theme="outline" size="small" bind:tap="onShowFilter">
        <t-icon name="filter" size="24rpx" />
        é«˜çº§ç­›é€‰
      </t-button>
    </view>
  </view>

  <!-- åœºåœ°åˆ—è¡¨ -->
  <scroll-view class="venue-list" scroll-y wx:if="{{viewMode === 'list'}}">
    <view class="venue-item" 
          wx:for="{{venues}}" 
          wx:key="id"
          bind:tap="onVenueTap"
          data-id="{{item.id}}">
      
      <!-- åœºåœ°å›¾ç‰‡ -->
      <view class="venue-image">
        <text class="venue-emoji">{{item.image}}</text>
        <view class="rating-badge">
          <t-icon name="star-filled" size="24rpx" color="#ffa502" />
          <text>{{item.rating}}</text>
        </view>
      </view>
      
      <!-- åœºåœ°ä¿¡æ¯ -->
      <view class="venue-info">
        <view class="venue-header">
          <view class="venue-name">{{item.name}}</view>
          <view class="venue-price">
            <text class="price">Â¥{{item.price}}</text>
            <text class="price-unit">/å°æ—¶</text>
          </view>
        </view>
        
        <view class="venue-meta">
          <view class="meta-item">
            <t-icon name="location" size="24rpx" color="#8a8a8a" />
            <text>{{item.distance}}km</text>
          </view>
          <view class="meta-item">
            <t-icon name="time" size="24rpx" color="#8a8a8a" />
            <text>{{item.openTime}}</text>
          </view>
        </view>
        
        <view class="venue-address">{{item.address}}</view>
        
        <!-- æ ‡ç­¾ -->
        <view class="venue-tags">
          <text class="tag" wx:for="{{item.tags}}" wx:key="*this">{{item}}</text>
        </view>
        
        <!-- æ“ä½œæŒ‰é’® -->
        <view class="venue-actions">
          <t-button 
            theme="outline" 
            size="small" 
            bind:tap="onCallVenue"
            data-phone="{{item.phone}}"
          >
            <t-icon name="call" size="24rpx" />
            ç”µè¯
          </t-button>
          <t-button 
            theme="outline" 
            size="small" 
            bind:tap="onNavigateToVenue"
            data-venue="{{item}}"
          >
            <t-icon name="location" size="24rpx" />
            å¯¼èˆª
          </t-button>
          <t-button theme="primary" size="small">
            é¢„è®¢
          </t-button>
        </view>
      </view>
    </view>
  </scroll-view>

  <!-- åœ°å›¾è§†å›¾å ä½ -->
  <view class="map-view" wx:if="{{viewMode === 'map'}}">
    <view class="map-placeholder">
      <t-icon name="location" size="120rpx" color="#d9d9d9" />
      <text class="placeholder-text">åœ°å›¾åŠŸèƒ½å¼€å‘ä¸­</text>
      <text class="placeholder-desc">å°†æ˜¾ç¤ºé™„è¿‘åœºåœ°ä½ç½®</text>
    </view>
  </view>

  <!-- åŸå¸‚é€‰æ‹©å™¨å¼¹çª— -->
  <t-popup 
    visible="{{showCitySelector}}" 
    placement="bottom"
    bind:visible-change="onCloseCitySelector"
  >
    <view class="city-popup">
      <view class="popup-header">
        <text class="popup-title">é€‰æ‹©åŸå¸‚</text>
        <t-icon name="close" bind:tap="onCloseCitySelector" />
      </view>
      <view class="city-grid">
        <view class="city-item" 
              wx:for="{{cities}}" 
              wx:key="*this"
              bind:tap="onCitySelect"
              data-city="{{item}}">
          <text class="{{currentCity === item ? 'selected' : ''}}">{{item}}</text>
        </view>
      </view>
    </view>
  </t-popup>
</view>