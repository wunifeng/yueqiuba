<!--pages/home/home.wxml-->
<view class="home-container">
  <!-- é¡¶éƒ¨åŒºåŸŸ -->
  <view class="top-section">
    <view class="header">
      <view class="city-selector" bind:tap="onCityTap">
        <text class="location-icon">ğŸ“</text>
        <text class="city-name">{{currentCity}}</text>
        <text class="arrow-down">â–¼</text>
      </view>
      <t-button theme="outline" size="small" bind:tap="onFilterTap">
        ç­›é€‰
      </t-button>
    </view>
    
    <!-- æœç´¢æ¡† -->
    <view class="search-section">
      <t-input
        placeholder="æœç´¢æ´»åŠ¨ã€åœºåœ°..."
        value="{{searchValue}}"
        bind:change="onSearchInput"
        bind:confirm="onSearchConfirm"
        prefix-icon="search"
        clearable
        class="search-input"
      />
    </view>
  </view>

  <!-- æ´»åŠ¨åˆ—è¡¨ -->
  <view class="activity-list">
    <view class="activity-item" 
          wx:for="{{activities}}" 
          wx:key="id" 
          bind:tap="onActivityTap"
          data-id="{{item.id}}">
      
      <!-- æ´»åŠ¨å›¾ç‰‡åŒºåŸŸ -->
      <view class="activity-image">
        <text class="sport-icon">{{item.image}}</text>
        <view class="activity-tag {{item.tagType}}" wx:if="{{item.tag}}">
          {{item.tag}}
        </view>
      </view>
      
      <!-- æ´»åŠ¨ä¿¡æ¯ -->
      <view class="activity-info">
        <view class="activity-title">{{item.title}}</view>
        
        <view class="activity-meta">
          <view class="meta-item">
            <t-icon name="time" size="24rpx" />
            <text>{{item.time}}</text>
          </view>
          <view class="meta-item">
            <t-icon name="location" size="24rpx" />
            <text>{{item.location}}</text>
          </view>
        </view>
        
        <view class="activity-footer">
          <view class="participant-info">
            å·²æŠ¥å {{item.participants}}/{{item.maxParticipants}} äºº
          </view>
          <view class="price-info">
            <text class="price">Â¥{{item.price}}</text>
            <text class="price-unit">äººå‡</text>
          </view>
        </view>
      </view>
    </view>
    
    <!-- åº•éƒ¨å†…å®¹åŒºåŸŸ -->
    <view class="bottom-content">
      <view class="load-more-hint">ä¸Šæ‹‰åŠ è½½æ›´å¤šæ´»åŠ¨</view>
    </view>
  </view>

  <!-- æ‚¬æµ®å‘å¸ƒæŒ‰é’® -->
  <view class="fab-container">
    <t-button 
      theme="primary" 
      shape="circle" 
      icon="add"
      bind:tap="onPublishTap"
      class="fab-button"
    />
  </view>

  <!-- åŸå¸‚é€‰æ‹©å™¨å¼¹çª— -->
  <t-popup 
    visible="{{showCitySelector}}" 
    placement="bottom"
    bind:visible-change="onCloseCitySelector"
  >
    <view class="city-popup">
      <view class="popup-header">
        <text class="popup-title">é€‰æ‹©åŸå¸‚</text>
        <t-icon name="close" bind:tap="onCloseCitySelector" />
      </view>
      <view class="city-grid">
        <view class="city-item" 
              wx:for="{{cities}}" 
              wx:key="*this"
              bind:tap="onCitySelect"
              data-city="{{item}}">
          <text class="{{currentCity === item ? 'selected' : ''}}">{{item}}</text>
        </view>
      </view>
    </view>
  </t-popup>
</view>